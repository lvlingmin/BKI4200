19.1.25--------------------------------------------
在组合测试界面点击开始,输出当前取放管孔位置。
在frmParent增加了全局变量tubeHoleNum，在
frmInstruGroupTest进行了Log文件记录当前孔号。

2019.02.11--------------------------------------------
frmParent.cs中增加public void countWashHole(int pace)方法，
对请洗盘顺时针或逆时针进行计数，并打印计数后当前孔位置。

2019.02.12--------------------------------------------
在工作界面（frmWorkList.cs）详细记录下，当前
请洗盘孔号，并在扔管命令发送时、清空请洗盘时、
撞管时、抓空时，打印当前位置，便于进行错误查找。

2019.02.18--------------------------------------------
在工作界面（frmDiagnost.cs.cs）增加清洗盘转动个数按钮，
可以进行正反向转动（范围时-30~30），functionButton1_Click_1，
并进行MessageBox()提示。

2019.02.19--------------------------------------------
更改心跳包发送时间为20000ms，保证socket中断后，能够较快连接，
保证数据发送不会中断。

2019.02.26--------------------------------------------
修改WorkList程序，避免死循环致使程序卡顿；增大程序Sleep时间，避免程序
占用过多资源。

2019.02.26--------------------------------------------
在Work中解决步骤进行完了没有变灰的问题，把当前变灰步骤之前的进度条变灰


2019.03.04--------------------------------------------
修改代码，在登录界面默认中文；本初修改之后，在展示版本增加使得记住用户名密码
默认中文。

2019.03.04--------------------------------------------
在登录界面为用户名添加模糊查询功能，自动提示用户名。在frmWorkList界面添加selectCombobox()模糊查询方法
在Load方法中查询数据用户名，在文本变化事件中进行判断，是否不全密码。

2019.03.06--------------------------------------------
在点击生成工作列表或工作列表中，增加删除已经完成实验BTestItem的清空功能(增加cleanDgvShowData方法)
，在实验完成情况下全部清空。


2019.03.06--------------------------------------------
在实验结果界面，增加数据导出功能。

2019.03.14--------------------------------------------
更改工作界面的排序为按照SampleNO进行，可以循环添加样本，修复了工作界面删除某一个未开始运行的实验，
样本盘无法添加问题，样本添加界面删除某一个样本连带删除的问题

2019.03.18--------------------------------------------
BioBaseCLIA\SysMaintenance\frmInstruGroupTest.cs增加循环灌注功能，
增加相应的加管，加液，清洗，扔管方法

2019.03.19--------------------------------------------
修复查询界面，查询结果导出报乱码异常

2019.03.22--------------------------------------------
装在试剂默认试剂总测数和剩余测数都是100

2019.03.22--------------------------------------------
使用NPOI重构对Excel操作，使得可以在不同版本间进行文件的操作，也可以在没有安装Office的情况下进行操作


2019.03.26--------------------------------------------
发现代码被覆盖，更新代码


2019.03.28--------------------------------------------
代码出现意外退出，在退出前没有任何征兆。我在程序的入口，Programe增加了捕获全局异常程序，包括多个捕获未处理异常，UI异常
非UI异常的的方法，以及一个写入到文件的Write方法，最终的异常文件会写入到ErrLogs文件夹中。
在样本添加界面，增加开始进行样本不允许再添加标准品的判断，并给出一个Dialog提示


2019.04.03--------------------------------------------
注销列宽自适应


2019.04.04--------------------------------------------
在Net3com中，endreceive之前增加sleep 300毫秒，保证接收数据结束

2019.04.04--------------------------------------------
组合测试，循环灌注次数改为1次。

2019.04.10--------------------------------------------
为调试界面增加一个温育盘某个位号的按钮

2019.04.10--------------------------------------------
从4月5号到现在的更改包括：

在Common中添加了一个BarCodeHook钩子类，实现无焦点的进行扫码的功能
在frmReagentLoad中建立钩子以及相应的处理事件
在frmAddScaling中，最开始的想法是进行弹出对话框进行扫码（因为扫码信息比较多，这样比较直观），
不过后来考虑到这样太繁琐，也用了建立钩子的无焦点的方式，不过保留了之前的弹框，
把弹框的按钮隐藏了，后期需要可以急需使用

另外，为了保证条码不要太长，条码的规则非常复杂，每一种条码的规则都不一样，
这一部分需要对照相应的生成条码程序和规则文档才能理顺。
生成条码的程序后期也会传上来，不过由于很多有关试剂和项目的信息还是不确定，这部分也没有完全确定，有待后期修改。

2019.04.12--------------------------------------------
在BarCodeHook方法中,增加了GC.Keep(),防止资源被回收而报错。
在AddScaling和ReagentLoad中不使用Hook的时候尽量关闭。

2019.04.19--------------------------------------------
查询结果和实验结果的导出的excel中左上角出现三角号，出现这种问题的原因是写入excel的数据全部是以文本的形式写入的，
而如果数字以文本的形式写入的话，出现的问题就三角号的出现。解决的方法是try/catch转换double，异常就用文本


2019.04.22--------------------------------------------
在信息F:\二代机\1编码\BioBaseCLIA(网口通讯)\BioBaseCLIA\InfoSetting\frmInfo.cs增加了导入项目前的重复删除，本来打算用一个事务来做，
后来觉得没有必要，并不是很对称的数据信息。

2019.04.23--------------------------------------------
为frmMessageShow的ShowMessage方法增加DialogResult返回值,更改frnMessageShow窗体为确定按钮增加一个DialogResult属性为OK

2019.04.26--------------------------------------------
frmDiagnose界面开始查询温度一段时间后，点击返回就会报一个nullreferencerefresh异常，在返回按钮添加timer.stop(),timer_Tick事件里chart1操作之前判断是否被回收和空，true就return

2019.04.30--------------------------------------------
解决软件退出后仪器仍在运行的问题，更改了退出点击事件

2019.05.31--------------------------------------------
更改所有的frmshowmessage的问题，这次更改了所有使用到的地方，提交了一个项目

2019.06.24--------------------------------------------
解决仪器初始化调试界面卡顿的问题

2019.06.29--------------------------------------------
只保留了一个生成工作列表按钮

2019.07.12--------------------------------------------
更改了组合测试界面的内容，在流程界面增加了灌注的功能，为每一个checkbox增加咯额默认的选中的状态，给了默认数字
修改了实验开始前的逻辑，将每次实验开始前进行的清洗的操作删除，改为单独在组合测试界面使用按钮进行每日例行清洗
修改了管架抓管错误的问题
为多个方法添加了打印信息，便于查找问题
重写了实验的调度算法，重写了空闲时间，重写了相关的代码
修改生成工作列表的问题，binData方法不用频繁进行数据库操作，一次查出数据后用DATa Table  linq查

2019.07.12--------------------------------------------
frmWOrklist界面增加一个completeTestNums全部变量，每完成一个实验增加，防止大样本连续添加显示的底物不够实验停止。

2019.07.19--------------------------------------------
屏蔽开始前的清洗操作，避免每次进行实验都会进行清洗，浪费时间和样本等
在组合测试界面增加清空温育盘的操作，目的是避免出现影响实验的操作。

2019.07.24--------------------------------------------
增加了一个抓空和撞管标志，直到重新开始实验SumTime开始增加。
增加下一个实验位置为空的判断，如果为空进行加新管操作。
修改了加多个定标出现的问题，之前是因为添加多个试剂会检测没有选择批号的试剂，显示让进行定标。

2019.07.29--------------------------------------------
在实验结果计算中会出现一个问题，到加样界面进行操作会clear CalculatResult(int testid, int pmt)方法中用到的dtSpInfo，导致的问题就是会出现异常
因为数据已经不存在的数据集合还在使用，这总情况不容易复现，采取的方法是先判断一下是否为空，如果不奏效的话再捕获一下异常，继续continue这样
如果dtSpInfo为空将会停止，不为空会继续判断

2019.08.10--------------------------------------------
为卸载试剂按钮增加一个判空，防止重复卸载出现异常

2019.08.16--------------------------------------------
登陆界面，点击登陆复选框不可用
修改理杯圾版本清洗盘抓管组合测试错误

2019.08.29--------------------------------------------
在润condition中修改7点定标的重复性数组越界的问题

2019.08.29--------------------------------------------
testResult设置为static 并增加GC>KeepAlive防止回收

2019.08.29--------------------------------------------
修改实验过程中添加的项目变成其他的项目的问题，在添加界面的seleciotnchanged中删除选中


2019.09.09--------------------------------------------
软件运行时，长时间的CPU的占用在30%以上，很不正常，分析了CPU使用后，
发现时frmMain中的Instance_QueryInfo的死循环占用了大量CPU时间，进行了修改

2019.09.25--------------------------------------------
修改了撞针后执行两次sendagain方法两次

2019.09.26--------------------------------------------
programme增加一个判断，只允许存在一个实例

2019.09.28--------------------------------------------
放开实验前进行清洗，注释掉实验结果显示不全的等待
统一项目中的磁珠和探针的名称

2019.10.06--------------------------------------------
使用Linq重写了项目导入

2019.10.07--------------------------------------------
CalculatResult中添加一个判断testResult为null或空进行跳转避免出现异常，
这种方法可以避免问题，但是原因还没找到。

2019.10.08--------------------------------------------
实验完成将FrmMain的pauseFlag标志设为false